Code is implemented using terrible variable names. I am sorry for this.